<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Your IP Address</title>
  <style>
    body {
      margin: 0;
      background: #080f13;
      color: white;
      font-family: sans-serif;
      font-size: 16px;
      text-align: center;
      padding: 20px;
    }
    #vpn-warning {
      color: red;
      font-weight: bold;
      margin-bottom: 10px;
      display: none;
    }
    #ipinfo {
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

<div id="vpn-warning"></div>
<div id="ipinfo">Loading...</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
      const allowedDomains = [
        'loopholezmedia.com',
        'www.loopholezmedia.com',
        'lpz.app',
        'internal.github.ip.lpz.app'
      ];

      const referrer = document.referrer;
      let referrerHost = null;
      try {
        if (referrer) {
          referrerHost = new URL(referrer).hostname;
        }
      } catch (e) {
        console.error('Invalid referrer URL', e);
      }

      const isEmbedded = window.top !== window.self;
      const isAllowed = !isEmbedded || allowedDomains.includes(referrerHost);

      if (!isAllowed) {
        const infoDiv = document.getElementById('ip-info');
        if (infoDiv) {
          infoDiv.innerHTML = `
            <div class="error">
              Error: This embed is not authorized on this domain.
            </div>
          `;
        }
        return;
      }

    // If allowed or not embedded, continue with existing IP info fetch & display code:

    const countryCodes = {
    "AF": "Afghanistan",
    "AL": "Albania",
    "DZ": "Algeria",
    "AS": "American Samoa",
    "AD": "Andorra",
    "AO": "Angola",
    "AI": "Anguilla",
    "AQ": "Antarctica",
    "AG": "Antigua and Barbuda",
    "AR": "Argentina",
    "AM": "Armenia",
    "AW": "Aruba",
    "AU": "Australia",
    "AT": "Austria",
    "AZ": "Azerbaijan",
    "BS": "Bahamas",
    "BH": "Bahrain",
    "BD": "Bangladesh",
    "BB": "Barbados",
    "BY": "Belarus",
    "BE": "Belgium",
    "BZ": "Belize",
    "BJ": "Benin",
    "BM": "Bermuda",
    "BT": "Bhutan",
    "BO": "Bolivia",
    "BA": "Bosnia and Herzegovina",
    "BW": "Botswana",
    "BR": "Brazil",
    "IO": "British Indian Ocean Territory",
    "VG": "British Virgin Islands",
    "BN": "Brunei",
    "BG": "Bulgaria",
    "BF": "Burkina Faso",
    "BI": "Burundi",
    "KH": "Cambodia",
    "CM": "Cameroon",
    "CA": "Canada",
    "CV": "Cape Verde",
    "KY": "Cayman Islands",
    "CF": "Central African Republic",
    "TD": "Chad",
    "CL": "Chile",
    "CN": "China",
    "CX": "Christmas Island",
    "CC": "Cocos Islands",
    "CO": "Colombia",
    "KM": "Comoros",
    "CK": "Cook Islands",
    "CR": "Costa Rica",
    "HR": "Croatia",
    "CU": "Cuba",
    "CW": "Curacao",
    "CY": "Cyprus",
    "CZ": "Czechia",
    "CD": "Democratic Republic of the Congo",
    "DK": "Denmark",
    "DJ": "Djibouti",
    "DM": "Dominica",
    "DO": "Dominican Republic",
    "EC": "Ecuador",
    "EG": "Egypt",
    "SV": "El Salvador",
    "GQ": "Equatorial Guinea",
    "ER": "Eritrea",
    "EE": "Estonia",
    "ET": "Ethiopia",
    "FK": "Falkland Islands",
    "FO": "Faroe Islands",
    "FJ": "Fiji",
    "FI": "Finland",
    "FR": "France",
    "PF": "French Polynesia",
    "GA": "Gabon",
    "GM": "Gambia",
    "GE": "Georgia",
    "DE": "Germany",
    "GH": "Ghana",
    "GI": "Gibraltar",
    "GR": "Greece",
    "GL": "Greenland",
    "GD": "Grenada",
    "GU": "Guam",
    "GT": "Guatemala",
    "GG": "Guernsey",
    "GN": "Guinea",
    "GW": "Guinea-Bissau",
    "GY": "Guyana",
    "HT": "Haiti",
    "HN": "Honduras",
    "HK": "Hong Kong",
    "HU": "Hungary",
    "IS": "Iceland",
    "IN": "India",
    "ID": "Indonesia",
    "IR": "Iran",
    "IQ": "Iraq",
    "IE": "Ireland",
    "IM": "Isle of Man",
    "IL": "Israel",
    "IT": "Italy",
    "CI": "Ivory Coast",
    "JM": "Jamaica",
    "JP": "Japan",
    "JE": "Jersey",
    "JO": "Jordan",
    "KZ": "Kazakhstan",
    "KE": "Kenya",
    "KI": "Kiribati",
    "XK": "Kosovo",
    "KW": "Kuwait",
    "KG": "Kyrgyzstan",
    "LA": "Laos",
    "LV": "Latvia",
    "LB": "Lebanon",
    "LS": "Lesotho",
    "LR": "Liberia",
    "LY": "Libya",
    "LI": "Liechtenstein",
    "LT": "Lithuania",
    "LU": "Luxembourg",
    "MO": "Macau",
    "MK": "North Macedonia",
    "MG": "Madagascar",
    "MW": "Malawi",
    "MY": "Malaysia",
    "MV": "Maldives",
    "ML": "Mali",
    "MT": "Malta",
    "MH": "Marshall Islands",
    "MR": "Mauritania",
    "MU": "Mauritius",
    "YT": "Mayotte",
    "MX": "Mexico",
    "FM": "Micronesia",
    "MD": "Moldova",
    "MC": "Monaco",
    "MN": "Mongolia",
    "ME": "Montenegro",
    "MS": "Montserrat",
    "MA": "Morocco",
    "MZ": "Mozambique",
    "MM": "Myanmar",
    "NA": "Namibia",
    "NR": "Nauru",
    "NP": "Nepal",
    "NL": "Netherlands",
    "NC": "New Caledonia",
    "NZ": "New Zealand",
    "NI": "Nicaragua",
    "NE": "Niger",
    "NG": "Nigeria",
    "NU": "Niue",
    "KP": "North Korea",
    "MP": "Northern Mariana Islands",
    "NO": "Norway",
    "OM": "Oman",
    "PK": "Pakistan",
    "PW": "Palau",
    "PS": "Palestine",
    "PA": "Panama",
    "PG": "Papua New Guinea",
    "PY": "Paraguay",
    "PE": "Peru",
    "PH": "Philippines",
    "PN": "Pitcairn",
    "PL": "Poland",
    "PT": "Portugal",
    "PR": "Puerto Rico",
    "QA": "Qatar",
    "CG": "Republic of the Congo",
    "RE": "Reunion",
    "RO": "Romania",
    "RU": "Russia",
    "RW": "Rwanda",
    "BL": "Saint Barthelemy",
    "SH": "Saint Helena",
    "KN": "Saint Kitts and Nevis",
    "LC": "Saint Lucia",
    "MF": "Saint Martin",
    "PM": "Saint Pierre and Miquelon",
    "VC": "Saint Vincent and the Grenadines",
    "WS": "Samoa",
    "SM": "San Marino",
    "ST": "Sao Tome and Principe",
    "SA": "Saudi Arabia",
    "SN": "Senegal",
    "RS": "Serbia",
    "SC": "Seychelles",
    "SL": "Sierra Leone",
    "SG": "Singapore",
    "SX": "Sint Maarten",
    "SK": "Slovakia",
    "SI": "Slovenia",
    "SB": "Solomon Islands",
    "SO": "Somalia",
    "ZA": "South Africa",
    "KR": "South Korea",
    "SS": "South Sudan",
    "ES": "Spain",
    "LK": "Sri Lanka",
    "SD": "Sudan",
    "SR": "Suriname",
    "SJ": "Svalbard and Jan Mayen",
    "SZ": "Swaziland",
    "SE": "Sweden",
    "CH": "Switzerland",
    "SY": "Syria",
    "TW": "Taiwan",
    "TJ": "Tajikistan",
    "TZ": "Tanzania",
    "TH": "Thailand",
    "TL": "Timor-Leste",
    "TG": "Togo",
    "TK": "Tokelau",
    "TO": "Tonga",
    "TT": "Trinidad and Tobago",
    "TN": "Tunisia",
    "TR": "Turkey",
    "TM": "Turkmenistan",
    "TC": "Turks and Caicos Islands",
    "TV": "Tuvalu",
    "UG": "Uganda",
    "UA": "Ukraine",
    "AE": "United Arab Emirates",
    "GB": "United Kingdom",
    "US": "United States",
    "UY": "Uruguay",
    "UZ": "Uzbekistan",
    "VU": "Vanuatu",
    "VA": "Vatican City",
    "VE": "Venezuela",
    "VN": "Vietnam",
    "WF": "Wallis and Futuna",
    "EH": "Western Sahara",
    "YE": "Yemen",
    "ZM": "Zambia",
    "ZW": "Zimbabwe"
    };

    function isVpnOrProxy(org) {
      if (!org) return false;
      const keywords = [
    "vpn", "proxy", "proxying", "tor", "hosted", "hosting", "digitalocean",
    "amazon aws", "amazon ec2", "linode", "cloudflare", "microsoft azure",
    "google cloud", "ovh", "hetzner", "vultr", "packet net", "fastly",
    "akamai", "proxy server", "private internet access", "pia", "expressvpn",
    "nordvpn", "surfshark", "ipvanish", "windscribe", "hide.me", "purevpn",
    "cyberghost", "ipredator", "strongvpn", "strong", "secure", "proton", "protonvpn"
      ];
      const orgLower = org.toLowerCase();
      return keywords.some(keyword => orgLower.includes(keyword));
    }

    fetch('https://ipinfo.io/json?token=YOUR_TOKEN_HERE')
      .then(response => response.json())
      .then(data => {
        let ipv4 = data.ip || '';
        let ipv6 = data.ipv6 || '';
        let org = data.org || '';
        let city = data.city || '';
        let region = data.region || '';
        let countryCode = data.country || '';
        let countryFull = countryCodes[countryCode] || countryCode;

        // Build output string, hide lines if empty
        let output = '';
        if (ipv4) output += `IPv4: ${ipv4}\n`;
        if (ipv6) output += `IPv6: ${ipv6}\n`;
        if (org) output += `ISP: ${org}\n`;
        if (city || region || countryFull) {
          output += `City: ${city}, ${region}, ${countryFull}`;
        }

        if (!ipv4 && !ipv6) {
          output = "You do not have an available IP address.";
        }

        document.getElementById('ipinfo').textContent = output;

        // VPN detection warning
        if (isVpnOrProxy(org)) {
          const vpnWarning = document.getElementById('vpn-warning');
          vpnWarning.textContent = 'You are using a VPN! The information displayed may be inaccurate!';
          vpnWarning.style.display = 'block';
        }
      })
      .catch(() => {
        document.getElementById('ipinfo').textContent = 'Failed to retrieve IP info.';
      });

  })();
</script>

</body>
</html>
</html>
